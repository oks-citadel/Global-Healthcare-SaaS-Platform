# Production Environment Values
# Used for production workloads - high availability and performance

global:
  environment: prod
  namespace: marketing-platform

  # AWS Configuration
  aws:
    region: us-east-1
    accountId: "123456789012"

  # Image configuration
  imageRegistry: 123456789012.dkr.ecr.us-east-1.amazonaws.com
  imagePullSecrets: []

  # Ingress configuration
  ingress:
    enabled: true
    className: alb
    annotations:
      kubernetes.io/ingress.class: alb
      alb.ingress.kubernetes.io/scheme: internet-facing
      alb.ingress.kubernetes.io/target-type: ip
      alb.ingress.kubernetes.io/healthcheck-path: /health
      alb.ingress.kubernetes.io/healthcheck-interval-seconds: "15"
      alb.ingress.kubernetes.io/healthcheck-timeout-seconds: "5"
      alb.ingress.kubernetes.io/healthy-threshold-count: "2"
      alb.ingress.kubernetes.io/unhealthy-threshold-count: "2"
      alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
      alb.ingress.kubernetes.io/ssl-redirect: "443"
      alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:us-east-1:123456789012:certificate/prod-cert-id
      alb.ingress.kubernetes.io/wafv2-acl-arn: arn:aws:wafv2:us-east-1:123456789012:regional/webacl/prod-waf/xxxxx
      alb.ingress.kubernetes.io/load-balancer-attributes: idle_timeout.timeout_seconds=60,routing.http2.enabled=true,routing.http.drop_invalid_header_fields.enabled=true
      alb.ingress.kubernetes.io/shield-advanced-protection: "true"
    domain: api.marketing.example.com
    tls:
      enabled: true

  # Database configuration
  database:
    host: marketing-prod-db.cluster-xxxxx.us-east-1.rds.amazonaws.com
    port: 5432
    sslMode: require

  # Redis configuration
  redis:
    host: marketing-prod-redis.xxxxx.cache.amazonaws.com
    port: 6379
    tls: true

  # Kafka configuration
  kafka:
    brokers:
      - b-1.marketing-prod-kafka.xxxxx.kafka.us-east-1.amazonaws.com:9096
      - b-2.marketing-prod-kafka.xxxxx.kafka.us-east-1.amazonaws.com:9096
      - b-3.marketing-prod-kafka.xxxxx.kafka.us-east-1.amazonaws.com:9096
    saslEnabled: true

  # S3 configuration
  s3:
    bucket: marketing-prod-assets
    region: us-east-1

  # Observability
  observability:
    metrics:
      enabled: true
      port: 9090
    tracing:
      enabled: true
      samplingRate: 0.1
    logging:
      level: info
      format: json

# Service-specific overrides for production
seo-service:
  enabled: true
  replicaCount: 3
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-seo-service
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - seo-service
          topologyKey: kubernetes.io/hostname

content-service:
  enabled: true
  replicaCount: 3
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-content-service
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 15
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - content-service
          topologyKey: kubernetes.io/hostname

analytics-service:
  enabled: true
  replicaCount: 5
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-analytics-service
  resources:
    limits:
      cpu: 2000m
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 512Mi
  autoscaling:
    enabled: true
    minReplicas: 5
    maxReplicas: 50
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70
  podDisruptionBudget:
    enabled: true
    minAvailable: 3
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - analytics-service
          topologyKey: kubernetes.io/hostname

personalization-service:
  enabled: true
  replicaCount: 3
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-personalization-service
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - personalization-service
          topologyKey: kubernetes.io/hostname

lifecycle-service:
  enabled: true
  replicaCount: 3
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-lifecycle-service
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - lifecycle-service
          topologyKey: kubernetes.io/hostname

growth-service:
  enabled: true
  replicaCount: 3
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-growth-service
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 15
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - growth-service
          topologyKey: kubernetes.io/hostname

commerce-service:
  enabled: true
  replicaCount: 3
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-commerce-service
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 256Mi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - commerce-service
          topologyKey: kubernetes.io/hostname

reputation-service:
  enabled: true
  replicaCount: 3
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-reputation-service
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - reputation-service
          topologyKey: kubernetes.io/hostname

localization-service:
  enabled: true
  replicaCount: 3
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-localization-service
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 15
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - localization-service
          topologyKey: kubernetes.io/hostname

ai-service:
  enabled: true
  replicaCount: 3
  image:
    tag: stable
  serviceAccount:
    irsaRoleArn: arn:aws:iam::123456789012:role/marketing-prod-ai-service
  resources:
    limits:
      cpu: 4000m
      memory: 8Gi
    requests:
      cpu: 1000m
      memory: 2Gi
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70
  podDisruptionBudget:
    enabled: true
    minAvailable: 2
  networkPolicy:
    enabled: true
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - ai-service
          topologyKey: kubernetes.io/hostname
  # For GPU nodes if using GPU-accelerated inference
  # nodeSelector:
  #   node.kubernetes.io/instance-type: g4dn.xlarge
  # tolerations:
  #   - key: nvidia.com/gpu
  #     operator: Exists
  #     effect: NoSchedule
