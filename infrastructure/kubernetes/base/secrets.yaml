---
# ============================================
# UnifiedHealth API - Secrets Template
# IMPORTANT: This is a template file with placeholders
# Actual values should be populated from AWS Secrets Manager
# ============================================
apiVersion: v1
kind: Secret
metadata:
  name: unified-health-secrets
  namespace: unified-health
  labels:
    app: unified-health-api
    component: secrets
  annotations:
    # AWS Secrets Manager integration
    secrets.store.csi.aws.amazon.com/secret-provider-class: unified-health-secrets
type: Opaque
stringData:
  # Database Credentials
  # Source: AWS Secrets Manager secret "unified-health/database"
  database-url: "postgresql://${DB_USERNAME}:${DB_PASSWORD}@${DB_HOST}:5432/${DB_NAME}?sslmode=require"
  database-username: "${DB_USERNAME}"
  database-password: "${DB_PASSWORD}"

  # JWT Configuration
  # Source: AWS Secrets Manager secret "unified-health/jwt"
  jwt-secret: "${JWT_SECRET}"
  jwt-refresh-secret: "${JWT_REFRESH_SECRET}"

  # Redis Configuration
  # Source: AWS Secrets Manager secret "unified-health/redis"
  redis-password: "${REDIS_PASSWORD}"
  redis-url: "redis://:${REDIS_PASSWORD}@unified-health-redis:6379"

  # Encryption Keys
  # Source: AWS Secrets Manager secret "unified-health/encryption"
  encryption-key: "${ENCRYPTION_KEY}"
  encryption-key-id: "${ENCRYPTION_KEY_ID}"

  # Data Encryption (for HIPAA compliance)
  data-encryption-key: "${DATA_ENCRYPTION_KEY}"
  phi-encryption-key: "${PHI_ENCRYPTION_KEY}"

  # API Keys for External Services
  # Source: AWS Secrets Manager secret "unified-health/sendgrid"
  sendgrid-api-key: "${SENDGRID_API_KEY}"

  # Source: AWS Secrets Manager secret "unified-health/twilio"
  twilio-account-sid: "${TWILIO_ACCOUNT_SID}"
  twilio-auth-token: "${TWILIO_AUTH_TOKEN}"

  # AWS S3 Configuration
  # Source: AWS Secrets Manager secret "unified-health/s3"
  aws-s3-bucket: "${AWS_S3_BUCKET}"
  aws-s3-region: "${AWS_S3_REGION}"

  # OAuth2 / OIDC Configuration
  # Source: AWS Secrets Manager secret "unified-health/oauth"
  oauth-client-id: "${OAUTH_CLIENT_ID}"
  oauth-client-secret: "${OAUTH_CLIENT_SECRET}"

  # Session Secret
  # Source: AWS Secrets Manager secret "unified-health/session"
  session-secret: "${SESSION_SECRET}"

  # Webhook Signing Secrets
  webhook-signing-secret: "${WEBHOOK_SIGNING_SECRET}"

  # Third-party Integration Secrets
  stripe-api-key: "${STRIPE_API_KEY}"
  stripe-webhook-secret: "${STRIPE_WEBHOOK_SECRET}"

---
# ============================================
# Instructions for populating secrets
# ============================================
# This file contains placeholder values that should be replaced with actual secrets
# from AWS Secrets Manager using one of the following methods:
#
# Method 1: AWS Secrets Store CSI Driver
# - Install the AWS Secrets Store CSI Driver
# - Configure SecretProviderClass to sync secrets from AWS Secrets Manager
#
# Method 2: External Secrets Operator
# - Install External Secrets Operator
# - Configure ExternalSecret resources to sync from AWS Secrets Manager
#
# Method 3: Manual replacement using envsubst or similar
# - Export environment variables from AWS Secrets Manager
# - Run: envsubst < secrets.yaml | kubectl apply -f -
#
# Method 4: CI/CD Pipeline
# - Retrieve secrets from AWS Secrets Manager in the pipeline
# - Inject them during deployment using kubectl or Helm
#
# NEVER commit actual secret values to source control!
# ============================================
