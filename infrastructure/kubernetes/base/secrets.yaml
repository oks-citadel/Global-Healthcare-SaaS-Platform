---
# ============================================
# UnifiedHealth API - Secrets Template
# IMPORTANT: This is a template file with placeholders
# Actual values should be populated from Azure Key Vault
# ============================================
apiVersion: v1
kind: Secret
metadata:
  name: unified-health-secrets
  namespace: unified-health
  labels:
    app: unified-health-api
    component: secrets
  annotations:
    # Azure Key Vault integration
    azure.workload.identity/use: "true"
    azure.workload.identity/tenant-id: "${AZURE_TENANT_ID}"
type: Opaque
stringData:
  # Database Credentials
  # Source: Azure Key Vault secret "database-url"
  database-url: "postgresql://${DB_USERNAME}:${DB_PASSWORD}@${DB_HOST}:5432/${DB_NAME}?sslmode=require"
  database-username: "${DB_USERNAME}"
  database-password: "${DB_PASSWORD}"

  # JWT Configuration
  # Source: Azure Key Vault secret "jwt-secret"
  jwt-secret: "${JWT_SECRET}"
  jwt-refresh-secret: "${JWT_REFRESH_SECRET}"

  # Redis Configuration
  # Source: Azure Key Vault secret "redis-password"
  redis-password: "${REDIS_PASSWORD}"
  redis-url: "redis://:${REDIS_PASSWORD}@unified-health-redis:6379"

  # Encryption Keys
  # Source: Azure Key Vault secret "encryption-key"
  encryption-key: "${ENCRYPTION_KEY}"
  encryption-key-id: "${ENCRYPTION_KEY_ID}"

  # Data Encryption (for HIPAA compliance)
  data-encryption-key: "${DATA_ENCRYPTION_KEY}"
  phi-encryption-key: "${PHI_ENCRYPTION_KEY}"

  # API Keys for External Services
  # Source: Azure Key Vault secret "sendgrid-api-key"
  sendgrid-api-key: "${SENDGRID_API_KEY}"

  # Source: Azure Key Vault secret "twilio-api-key"
  twilio-account-sid: "${TWILIO_ACCOUNT_SID}"
  twilio-auth-token: "${TWILIO_AUTH_TOKEN}"

  # Azure Storage Account
  # Source: Azure Key Vault secret "storage-account-key"
  azure-storage-account-name: "${AZURE_STORAGE_ACCOUNT_NAME}"
  azure-storage-account-key: "${AZURE_STORAGE_ACCOUNT_KEY}"
  azure-storage-connection-string: "DefaultEndpointsProtocol=https;AccountName=${AZURE_STORAGE_ACCOUNT_NAME};AccountKey=${AZURE_STORAGE_ACCOUNT_KEY};EndpointSuffix=core.windows.net"

  # OAuth2 / OIDC Configuration
  # Source: Azure Key Vault secret "oauth-client-secret"
  oauth-client-id: "${OAUTH_CLIENT_ID}"
  oauth-client-secret: "${OAUTH_CLIENT_SECRET}"

  # Session Secret
  # Source: Azure Key Vault secret "session-secret"
  session-secret: "${SESSION_SECRET}"

  # Webhook Signing Secrets
  webhook-signing-secret: "${WEBHOOK_SIGNING_SECRET}"

  # Third-party Integration Secrets
  stripe-api-key: "${STRIPE_API_KEY}"
  stripe-webhook-secret: "${STRIPE_WEBHOOK_SECRET}"

---
# ============================================
# Instructions for populating secrets
# ============================================
# This file contains placeholder values that should be replaced with actual secrets
# from Azure Key Vault using one of the following methods:
#
# Method 1: Azure Key Vault CSI Driver
# - Install the Azure Key Vault Provider for Secrets Store CSI Driver
# - Configure SecretProviderClass to sync secrets from Azure Key Vault
#
# Method 2: External Secrets Operator
# - Install External Secrets Operator
# - Configure ExternalSecret resources to sync from Azure Key Vault
#
# Method 3: Manual replacement using envsubst or similar
# - Export environment variables from Azure Key Vault
# - Run: envsubst < secrets.yaml | kubectl apply -f -
#
# Method 4: CI/CD Pipeline
# - Retrieve secrets from Azure Key Vault in the pipeline
# - Inject them during deployment using kubectl or Helm
#
# NEVER commit actual secret values to source control!
# ============================================
