openapi: 3.0.0
info:
  title: Unified Health Platform API
  version: 1.0.0
  description: |
    Comprehensive healthcare API for managing patients, appointments, encounters, documents, and more.

    ## Features
    - Multi-tenant architecture
    - HIPAA-compliant data handling
    - Role-based access control (RBAC)
    - Real-time notifications
    - Document management with encryption
    - Telehealth capabilities
    - Billing and subscription management

    ## Authentication
    All endpoints (except health checks and public config) require JWT authentication.
    Include the token in the Authorization header:
    ```
    Authorization: Bearer <your-jwt-token>
    ```
  contact:
    name: API Support
    email: api-support@theunifiedhealth.com
    url: https://docs.theunifiedhealth.com
  license:
    name: Proprietary
    url: https://theunifiedhealth.com/license
servers:
  - url: http://localhost:3000/api/v1
    description: Development server
  - url: https://api-staging.theunifiedhealth.com/api/v1
    description: Staging server
  - url: https://api.theunifiedhealth.com/api/v1
    description: Production server
tags:
  - name: System
    description: System health and configuration
  - name: Authentication
    description: User authentication and authorization
  - name: Users
    description: User management
  - name: Patients
    description: Patient information management
  - name: Appointments
    description: Appointment scheduling and management
  - name: Encounters
    description: Clinical encounters and notes
  - name: Documents
    description: Document storage and retrieval
  - name: Visits
    description: Telehealth visits
  - name: Plans
    description: Subscription plans
  - name: Subscriptions
    description: Organization subscriptions
  - name: Payments
    description: Payment processing
  - name: Billing
    description: Billing webhooks and management
  - name: Notifications
    description: Email, SMS, and push notifications
  - name: Audit
    description: Audit logs and compliance
  - name: Consent
    description: Patient consent management
  - name: Dashboard
    description: Dashboard statistics and quick actions
  - name: Premium
    description: Premium subscription features
  - name: Discharges
    description: Post-discharge follow-up management
  - name: Surgical
    description: Surgical scheduling and OR management
security:
  - bearerAuth: []
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: "Enter your JWT token in the format: Bearer {token}"
  schemas:
    UUID:
      type: string
      format: uuid
      description: UUID identifier
      example: 550e8400-e29b-41d4-a716-446655440000
    PaginationQuery:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
          default: 1
          description: Page number
          example: 1
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
          description: Items per page
          example: 20
    PaginationMeta:
      type: object
      properties:
        page:
          type: integer
          example: 1
        limit:
          type: integer
          example: 20
        total:
          type: integer
          example: 100
        totalPages:
          type: integer
          example: 5
    Error:
      type: object
      properties:
        error:
          type: string
          example: Error
        message:
          type: string
          example: An error occurred
        timestamp:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"
        path:
          type: string
          example: /api/v1/resource
    ValidationError:
      type: object
      properties:
        error:
          type: string
          enum:
            - Validation Error
        message:
          type: string
          example: Invalid request data
        errors:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
                example: email
              message:
                type: string
                example: Invalid email format
    RegisterRequest:
      type: object
      required:
        - email
        - password
        - firstName
        - lastName
      properties:
        email:
          type: string
          format: email
          description: User email address
          example: user@example.com
        password:
          type: string
          minLength: 12
          description: Password (minimum 12 characters)
          example: SecurePassword123!
        firstName:
          type: string
          minLength: 1
          maxLength: 100
          description: First name
          example: John
        lastName:
          type: string
          minLength: 1
          maxLength: 100
          description: Last name
          example: Doe
        phone:
          type: string
          description: Phone number
          example: "+1-555-555-5555"
        dateOfBirth:
          type: string
          format: date
          description: Date of birth (ISO format)
          example: "1990-01-15"
        role:
          type: string
          enum:
            - patient
            - provider
            - admin
          default: patient
          description: User role
          example: patient
    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          description: User email address
          example: user@example.com
        password:
          type: string
          description: User password
          example: SecurePassword123!
    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: User ID
        email:
          type: string
          format: email
          example: user@example.com
        firstName:
          type: string
          example: John
        lastName:
          type: string
          example: Doe
        role:
          type: string
          enum:
            - patient
            - provider
            - admin
          example: patient
        createdAt:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"
    AuthResponse:
      type: object
      properties:
        accessToken:
          type: string
          description: JWT access token
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        refreshToken:
          type: string
          description: JWT refresh token
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        expiresIn:
          type: integer
          description: Token expiration time in seconds
          example: 3600
        tokenType:
          type: string
          enum:
            - Bearer
          example: Bearer
        user:
          $ref: "#/components/schemas/User"
    Patient:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Patient ID
        userId:
          type: string
          format: uuid
          description: Associated user ID
        mrn:
          type: string
          description: Medical Record Number
          example: MRN-2024-001234
        firstName:
          type: string
          example: John
        lastName:
          type: string
          example: Doe
        dateOfBirth:
          type: string
          format: date
          example: "1990-01-15"
        gender:
          type: string
          enum:
            - male
            - female
            - other
          example: male
        email:
          type: string
          format: email
          example: patient@example.com
        phone:
          type: string
          example: "+1-555-555-5555"
        address:
          type: string
          example: 123 Main St, City, ST 12345
        emergencyContact:
          type: object
          properties:
            name:
              type: string
              example: Jane Doe
            relationship:
              type: string
              example: Spouse
            phone:
              type: string
              example: "+1-555-555-5556"
        createdAt:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"
    Appointment:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Appointment ID
        patientId:
          type: string
          format: uuid
          description: Patient ID
        providerId:
          type: string
          format: uuid
          description: Provider ID
        scheduledAt:
          type: string
          format: date-time
          example: "2024-01-20T10:00:00.000Z"
        duration:
          type: integer
          description: Duration in minutes
          example: 30
        type:
          type: string
          enum:
            - in-person
            - telehealth
          example: telehealth
        status:
          type: string
          enum:
            - scheduled
            - confirmed
            - checked-in
            - in-progress
            - completed
            - cancelled
            - no-show
          example: scheduled
        reason:
          type: string
          example: Annual checkup
        notes:
          type: string
          example: Patient requested early morning slot
        createdAt:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"
    Encounter:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Encounter ID
        patientId:
          type: string
          format: uuid
          description: Patient ID
        providerId:
          type: string
          format: uuid
          description: Provider ID
        appointmentId:
          type: string
          format: uuid
          description: Associated appointment ID
        status:
          type: string
          enum:
            - planned
            - in-progress
            - finished
            - cancelled
          example: in-progress
        type:
          type: string
          example: consultation
        chiefComplaint:
          type: string
          example: Persistent headache
        diagnosis:
          type: array
          items:
            type: object
            properties:
              code:
                type: string
                example: G43.909
              description:
                type: string
                example: Migraine, unspecified
        vitals:
          type: object
          properties:
            bloodPressureSystolic:
              type: number
              example: 120
            bloodPressureDiastolic:
              type: number
              example: 80
            heartRate:
              type: number
              example: 72
            temperature:
              type: number
              example: 98.6
            weight:
              type: number
              example: 165
        startedAt:
          type: string
          format: date-time
          example: "2024-01-20T10:00:00.000Z"
        endedAt:
          type: string
          format: date-time
          example: "2024-01-20T10:30:00.000Z"
        createdAt:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"
    Document:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Document ID
        patientId:
          type: string
          format: uuid
          description: Patient ID
        uploadedBy:
          type: string
          format: uuid
          description: Uploader user ID
        filename:
          type: string
          example: lab-results-2024.pdf
        mimeType:
          type: string
          example: application/pdf
        size:
          type: integer
          description: File size in bytes
          example: 102400
        category:
          type: string
          enum:
            - lab-result
            - imaging
            - prescription
            - insurance
            - consent
            - other
          example: lab-result
        encrypted:
          type: boolean
          example: true
        createdAt:
          type: string
          format: date-time
          example: "2024-01-15T12:00:00.000Z"
    Plan:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Plan ID
        name:
          type: string
          example: Professional
        description:
          type: string
          example: Full-featured plan for healthcare providers
        price:
          type: number
          example: 99.99
        interval:
          type: string
          enum:
            - month
            - year
          example: month
        features:
          type: array
          items:
            type: string
          example:
            - Unlimited patients
            - Telehealth
            - AI features
        tier:
          type: string
          enum:
            - free
            - basic
            - professional
            - enterprise
          example: professional
paths:
  /version:
    get:
      tags:
        - System
      summary: Get API version
      security: []
      responses:
        "200":
          description: API version information
          content:
            application/json:
              schema:
                type: object
                properties:
                  version:
                    type: string
                    example: "1.0.0"
                  environment:
                    type: string
                    example: development
  /config/public:
    get:
      tags:
        - System
      summary: Get public configuration
      security: []
      responses:
        "200":
          description: Public configuration settings
          content:
            application/json:
              schema:
                type: object
                properties:
                  stripePublishableKey:
                    type: string
                  features:
                    type: object
                    additionalProperties:
                      type: boolean
  /dashboard/stats:
    get:
      tags:
        - Dashboard
      summary: Get dashboard statistics
      responses:
        "200":
          description: Dashboard statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  patients:
                    type: integer
                    example: 150
                  appointments:
                    type: integer
                    example: 25
                  encounters:
                    type: integer
                    example: 200
                  documents:
                    type: integer
                    example: 500
        "401":
          description: Unauthorized
  /dashboard/quick-actions:
    get:
      tags:
        - Dashboard
      summary: Get quick actions for dashboard
      responses:
        "200":
          description: Available quick actions
          content:
            application/json:
              schema:
                type: object
                properties:
                  actions:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        label:
                          type: string
                        icon:
                          type: string
                        href:
                          type: string
        "401":
          description: Unauthorized
  /auth/register:
    post:
      tags:
        - Authentication
      summary: Register a new user
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterRequest"
      responses:
        "201":
          description: User registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  user:
                    $ref: "#/components/schemas/User"
        "400":
          description: Validation error
        "409":
          description: Email already exists
  /auth/login:
    post:
      tags:
        - Authentication
      summary: Login with email and password
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "401":
          description: Invalid credentials
  /auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh access token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
      responses:
        "200":
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                  refreshToken:
                    type: string
                  expiresIn:
                    type: integer
        "401":
          description: Invalid refresh token
  /auth/logout:
    post:
      tags:
        - Authentication
      summary: Logout current user
      responses:
        "200":
          description: Logged out successfully
        "401":
          description: Unauthorized
  /auth/me:
    get:
      tags:
        - Authentication
      summary: Get current user profile
      responses:
        "200":
          description: Current user profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "401":
          description: Unauthorized
  /users/{id}:
    get:
      tags:
        - Users
      summary: Get user by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: User details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "401":
          description: Unauthorized
        "404":
          description: User not found
    patch:
      tags:
        - Users
      summary: Update user
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                phone:
                  type: string
      responses:
        "200":
          description: User updated successfully
        "401":
          description: Unauthorized
        "404":
          description: User not found
  /users/me/export:
    get:
      tags:
        - Users
      summary: Export user data (GDPR Article 20)
      description: Right to data portability
      responses:
        "200":
          description: User data export
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    type: object
                  patients:
                    type: array
                    items:
                      type: object
                  appointments:
                    type: array
                    items:
                      type: object
                  documents:
                    type: array
                    items:
                      type: object
        "401":
          description: Unauthorized
  /users/me:
    delete:
      tags:
        - Users
      summary: Delete user account (GDPR Article 17)
      description: Right to erasure
      responses:
        "200":
          description: Account deleted successfully
        "401":
          description: Unauthorized
  /patients:
    post:
      tags:
        - Patients
      summary: Create a new patient
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - firstName
                - lastName
                - dateOfBirth
                - gender
                - email
                - phone
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                dateOfBirth:
                  type: string
                  format: date
                gender:
                  type: string
                  enum:
                    - male
                    - female
                    - other
                email:
                  type: string
                  format: email
                phone:
                  type: string
                address:
                  type: string
      responses:
        "201":
          description: Patient created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Patient"
        "400":
          description: Validation error
        "401":
          description: Unauthorized
  /patients/{id}:
    get:
      tags:
        - Patients
      summary: Get patient by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Patient details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Patient"
        "401":
          description: Unauthorized
        "404":
          description: Patient not found
    patch:
      tags:
        - Patients
      summary: Update patient
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                phone:
                  type: string
                address:
                  type: string
      responses:
        "200":
          description: Patient updated successfully
        "401":
          description: Unauthorized
        "404":
          description: Patient not found
  /encounters:
    post:
      tags:
        - Encounters
      summary: Create a new encounter
      description: Requires provider or admin role
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - patientId
                - type
              properties:
                patientId:
                  type: string
                  format: uuid
                appointmentId:
                  type: string
                  format: uuid
                type:
                  type: string
                chiefComplaint:
                  type: string
      responses:
        "201":
          description: Encounter created successfully
        "400":
          description: Validation error
        "401":
          description: Unauthorized
        "403":
          description: Forbidden - requires provider or admin role
    get:
      tags:
        - Encounters
      summary: List encounters
      parameters:
        - name: patientId
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum:
              - planned
              - in-progress
              - finished
              - cancelled
        - name: page
          in: query
          schema:
            type: integer
        - name: limit
          in: query
          schema:
            type: integer
      responses:
        "200":
          description: List of encounters
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Encounter"
                  pagination:
                    $ref: "#/components/schemas/PaginationMeta"
        "401":
          description: Unauthorized
  /encounters/{id}:
    get:
      tags:
        - Encounters
      summary: Get encounter by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Encounter details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Encounter"
        "401":
          description: Unauthorized
        "404":
          description: Encounter not found
    patch:
      tags:
        - Encounters
      summary: Update encounter
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Encounter updated successfully
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
        "404":
          description: Encounter not found
  /encounters/{id}/notes:
    post:
      tags:
        - Encounters
      summary: Add clinical note to encounter
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                type:
                  type: string
      responses:
        "201":
          description: Clinical note added
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
    get:
      tags:
        - Encounters
      summary: Get clinical notes for encounter
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: List of clinical notes
        "401":
          description: Unauthorized
  /encounters/{id}/start:
    post:
      tags:
        - Encounters
      summary: Start an encounter
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Encounter started
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
  /encounters/{id}/end:
    post:
      tags:
        - Encounters
      summary: End an encounter
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Encounter ended
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
  /documents:
    post:
      tags:
        - Documents
      summary: Upload a document
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
                - patientId
                - category
              properties:
                file:
                  type: string
                  format: binary
                patientId:
                  type: string
                  format: uuid
                category:
                  type: string
                  enum:
                    - lab-result
                    - imaging
                    - prescription
                    - insurance
                    - consent
                    - other
      responses:
        "201":
          description: Document uploaded successfully
        "400":
          description: Validation error
        "401":
          description: Unauthorized
    get:
      tags:
        - Documents
      summary: List documents
      parameters:
        - name: patientId
          in: query
          schema:
            type: string
            format: uuid
        - name: category
          in: query
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
        - name: limit
          in: query
          schema:
            type: integer
      responses:
        "200":
          description: List of documents
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Document"
                  pagination:
                    $ref: "#/components/schemas/PaginationMeta"
        "401":
          description: Unauthorized
  /documents/{id}:
    get:
      tags:
        - Documents
      summary: Get document metadata
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Document metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
        "401":
          description: Unauthorized
        "404":
          description: Document not found
    delete:
      tags:
        - Documents
      summary: Delete a document
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Document deleted
        "401":
          description: Unauthorized
        "404":
          description: Document not found
  /documents/{id}/download:
    get:
      tags:
        - Documents
      summary: Get document download URL
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Presigned download URL
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    format: uri
                  expiresAt:
                    type: string
                    format: date-time
        "401":
          description: Unauthorized
        "404":
          description: Document not found
  /appointments:
    post:
      tags:
        - Appointments
      summary: Create an appointment
      description: Requires active subscription
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - patientId
                - providerId
                - scheduledAt
                - duration
                - type
              properties:
                patientId:
                  type: string
                  format: uuid
                providerId:
                  type: string
                  format: uuid
                scheduledAt:
                  type: string
                  format: date-time
                duration:
                  type: integer
                type:
                  type: string
                  enum:
                    - in-person
                    - telehealth
                reason:
                  type: string
      responses:
        "201":
          description: Appointment created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Appointment"
        "400":
          description: Validation error
        "401":
          description: Unauthorized
        "402":
          description: Payment required - subscription needed
    get:
      tags:
        - Appointments
      summary: List appointments
      parameters:
        - name: patientId
          in: query
          schema:
            type: string
            format: uuid
        - name: providerId
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: page
          in: query
          schema:
            type: integer
        - name: limit
          in: query
          schema:
            type: integer
      responses:
        "200":
          description: List of appointments
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Appointment"
                  pagination:
                    $ref: "#/components/schemas/PaginationMeta"
        "401":
          description: Unauthorized
  /appointments/{id}:
    get:
      tags:
        - Appointments
      summary: Get appointment by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Appointment details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Appointment"
        "401":
          description: Unauthorized
        "404":
          description: Appointment not found
    patch:
      tags:
        - Appointments
      summary: Update appointment
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Appointment updated
        "401":
          description: Unauthorized
        "402":
          description: Payment required
        "404":
          description: Appointment not found
    delete:
      tags:
        - Appointments
      summary: Cancel appointment
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Appointment cancelled
        "401":
          description: Unauthorized
        "404":
          description: Appointment not found
  /plans:
    get:
      tags:
        - Plans
      summary: List available subscription plans
      security: []
      responses:
        "200":
          description: List of plans
          content:
            application/json:
              schema:
                type: object
                properties:
                  plans:
                    type: array
                    items:
                      $ref: "#/components/schemas/Plan"
  /subscriptions:
    post:
      tags:
        - Subscriptions
      summary: Create a subscription
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - planId
              properties:
                planId:
                  type: string
                  format: uuid
                paymentMethodId:
                  type: string
      responses:
        "201":
          description: Subscription created
        "400":
          description: Validation error
        "401":
          description: Unauthorized
  /subscriptions/{id}:
    delete:
      tags:
        - Subscriptions
      summary: Cancel subscription
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Subscription cancelled
        "401":
          description: Unauthorized
        "404":
          description: Subscription not found
  /payments/config:
    get:
      tags:
        - Payments
      summary: Get payment configuration
      security: []
      responses:
        "200":
          description: Payment configuration
          content:
            application/json:
              schema:
                type: object
                properties:
                  publishableKey:
                    type: string
  /payments/setup-intent:
    post:
      tags:
        - Payments
      summary: Create a Stripe SetupIntent
      responses:
        "200":
          description: SetupIntent created
          content:
            application/json:
              schema:
                type: object
                properties:
                  clientSecret:
                    type: string
        "401":
          description: Unauthorized
  /payments/payment-methods:
    get:
      tags:
        - Payments
      summary: List saved payment methods
      responses:
        "200":
          description: List of payment methods
        "401":
          description: Unauthorized
  /payments/history:
    get:
      tags:
        - Payments
      summary: Get payment history
      responses:
        "200":
          description: Payment history
        "401":
          description: Unauthorized
  /telehealth/video-session:
    post:
      tags:
        - Premium
      summary: Create a telehealth video session
      description: Requires active subscription
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - patientId
                - providerId
              properties:
                patientId:
                  type: string
                  format: uuid
                providerId:
                  type: string
                  format: uuid
      responses:
        "200":
          description: Video session created
          content:
            application/json:
              schema:
                type: object
                properties:
                  sessionId:
                    type: string
                  roomUrl:
                    type: string
                    format: uri
                  expiresAt:
                    type: string
                    format: date-time
        "401":
          description: Unauthorized
        "402":
          description: Payment required - subscription needed
  /ai/analyze-symptoms:
    post:
      tags:
        - Premium
      summary: AI-powered symptom analysis
      description: Requires premium tier subscription
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - symptoms
              properties:
                symptoms:
                  type: array
                  items:
                    type: string
      responses:
        "200":
          description: Symptom analysis results
          content:
            application/json:
              schema:
                type: object
                properties:
                  analysisId:
                    type: string
                  possibleConditions:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                        probability:
                          type: number
                  recommendation:
                    type: string
                  disclaimer:
                    type: string
        "401":
          description: Unauthorized
        "402":
          description: Payment required - premium subscription needed
  /discharges/{encounterId}/initiate:
    post:
      tags:
        - Discharges
      summary: Initiate discharge workflow
      parameters:
        - name: encounterId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "201":
          description: Discharge workflow initiated
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
  /discharges/{id}:
    get:
      tags:
        - Discharges
      summary: Get discharge workflow details
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Discharge workflow details
        "401":
          description: Unauthorized
        "404":
          description: Discharge not found
  /discharges/{patientId}/risk-score:
    get:
      tags:
        - Discharges
      summary: Get LACE+ readmission risk score
      parameters:
        - name: patientId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Risk score
          content:
            application/json:
              schema:
                type: object
                properties:
                  score:
                    type: number
                  riskLevel:
                    type: string
                    enum:
                      - low
                      - medium
                      - high
                  factors:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                        value:
                          type: number
                        contribution:
                          type: number
        "401":
          description: Unauthorized
  /surgical/blocks:
    post:
      tags:
        - Surgical
      summary: Create OR block schedule
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - operatingRoomId
                - surgeonId
                - date
                - startTime
                - endTime
                - blockType
                - specialty
              properties:
                operatingRoomId:
                  type: string
                  format: uuid
                surgeonId:
                  type: string
                  format: uuid
                date:
                  type: string
                  format: date-time
                startTime:
                  type: string
                  example: "08:00"
                endTime:
                  type: string
                  example: "12:00"
                blockType:
                  type: string
                  enum:
                    - dedicated
                    - shared
                    - open
                    - emergency_reserve
                specialty:
                  type: string
      responses:
        "201":
          description: OR block created
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
    get:
      tags:
        - Surgical
      summary: List OR blocks
      parameters:
        - name: operatingRoomId
          in: query
          schema:
            type: string
            format: uuid
        - name: surgeonId
          in: query
          schema:
            type: string
            format: uuid
        - name: date
          in: query
          schema:
            type: string
            format: date
        - name: page
          in: query
          schema:
            type: integer
        - name: limit
          in: query
          schema:
            type: integer
      responses:
        "200":
          description: List of OR blocks
        "401":
          description: Unauthorized
  /surgical/cases:
    post:
      tags:
        - Surgical
      summary: Schedule a surgical case
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - patientId
                - primarySurgeonId
                - procedureCode
                - procedureName
                - scheduledDate
                - estimatedDuration
                - priority
                - anesthesiaType
              properties:
                patientId:
                  type: string
                  format: uuid
                primarySurgeonId:
                  type: string
                  format: uuid
                procedureCode:
                  type: string
                procedureName:
                  type: string
                scheduledDate:
                  type: string
                  format: date-time
                estimatedDuration:
                  type: integer
                  description: Duration in minutes
                priority:
                  type: string
                  enum:
                    - elective
                    - urgent
                    - emergent
                anesthesiaType:
                  type: string
                  enum:
                    - general
                    - regional
                    - local
                    - sedation
                    - none
      responses:
        "201":
          description: Surgical case scheduled
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
  /surgical/utilization:
    get:
      tags:
        - Surgical
      summary: Get utilization analytics
      parameters:
        - name: from
          in: query
          required: true
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          required: true
          schema:
            type: string
            format: date-time
        - name: groupBy
          in: query
          schema:
            type: string
            enum:
              - room
              - surgeon
              - specialty
              - day
              - week
              - month
      responses:
        "200":
          description: Utilization analytics
          content:
            application/json:
              schema:
                type: object
                properties:
                  period:
                    type: object
                    properties:
                      from:
                        type: string
                        format: date-time
                      to:
                        type: string
                        format: date-time
                  summary:
                    type: object
                    properties:
                      totalCases:
                        type: integer
                      averageUtilization:
                        type: number
                      totalMinutes:
                        type: integer
                  breakdown:
                    type: array
                    items:
                      type: object
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
  /surgical/emergency-insert:
    post:
      tags:
        - Surgical
      summary: Insert emergency case into schedule
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - patientId
                - primarySurgeonId
                - procedureCode
                - procedureName
                - estimatedDuration
                - priority
                - anesthesiaType
                - preOpDiagnosis
              properties:
                patientId:
                  type: string
                  format: uuid
                primarySurgeonId:
                  type: string
                  format: uuid
                procedureCode:
                  type: string
                procedureName:
                  type: string
                estimatedDuration:
                  type: integer
                priority:
                  type: string
                  enum:
                    - urgent
                    - emergent
                anesthesiaType:
                  type: string
                preOpDiagnosis:
                  type: string
      responses:
        "201":
          description: Emergency case inserted
          content:
            application/json:
              schema:
                type: object
                properties:
                  caseId:
                    type: string
                    format: uuid
                  insertionSuccessful:
                    type: boolean
                  assignedRoom:
                    type: object
                  estimatedStartTime:
                    type: string
                    format: date-time
                  displacedCases:
                    type: array
                    items:
                      type: object
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
