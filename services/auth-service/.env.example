# Server Configuration
PORT=3001
NODE_ENV=development

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/auth_db?schema=public

# JWT Configuration
# For development (HS256)
JWT_SECRET=your-secret-key-change-in-production-min-32-characters
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=30d

# For production (RS256) - Uncomment and provide paths
# JWT_PRIVATE_KEY_PATH=/path/to/private.key
# JWT_PUBLIC_KEY_PATH=/path/to/public.key

# Security
BCRYPT_ROUNDS=12
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15
PASSWORD_RESET_EXPIRY_HOURS=1
EMAIL_VERIFICATION_EXPIRY_HOURS=24

# CORS
# Note: Wildcard (*) cannot be used with credentials: true - browsers will reject the response.
# Use comma-separated explicit origins instead.
CORS_ORIGIN=http://localhost:3000,http://localhost:3001,http://localhost:3002

# Logging
LOG_LEVEL=info

# MFA Configuration
MFA_ISSUER=UnifiedHealthcare
MFA_ENCRYPTION_KEY=your-mfa-encryption-key-change-in-production-min-32-chars

# ==========================================
# OAuth2 / Social Login Configuration
# ==========================================

# OAuth General Settings
OAUTH_CALLBACK_BASE_URL=http://localhost:3001
OAUTH_DEFAULT_REDIRECT_URL=http://localhost:3000/auth/callback
OAUTH_ALLOWED_REDIRECTS=http://localhost:3000/*,https://yourdomain.com/*
OAUTH_STATE_EXPIRY_MINUTES=10
OAUTH_TOKEN_ENCRYPTION_KEY=your-oauth-token-encryption-key-32-chars

# Google OAuth2
# Get credentials from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Facebook OAuth
# Get credentials from: https://developers.facebook.com/apps
FACEBOOK_APP_ID=your-facebook-app-id
FACEBOOK_APP_SECRET=your-facebook-app-secret

# Apple Sign-In
# Get credentials from: https://developer.apple.com/account/resources/identifiers
APPLE_CLIENT_ID=com.yourapp.service
APPLE_TEAM_ID=your-apple-team-id
APPLE_KEY_ID=your-apple-key-id
# For the private key, either:
# 1. Use escaped newlines: -----BEGIN PRIVATE KEY-----\nMIGTAgEA...\n-----END PRIVATE KEY-----
# 2. Or store in a file and reference via APPLE_PRIVATE_KEY_PATH
APPLE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nYour-Apple-Private-Key-Here\n-----END PRIVATE KEY-----
# APPLE_PRIVATE_KEY_PATH=/path/to/AuthKey_XXXXX.p8

# Microsoft OAuth2 (Azure AD / Microsoft Entra ID)
# Get credentials from: https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps
MICROSOFT_CLIENT_ID=your-microsoft-client-id
MICROSOFT_CLIENT_SECRET=your-microsoft-client-secret
# Tenant options: 'common' (any account), 'organizations' (work/school), 'consumers' (personal), or specific tenant ID
MICROSOFT_TENANT=common

# ==========================================
# Redis Configuration (Optional - for session management)
# ==========================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Application URL (for email links and OAuth redirects)
APP_URL=http://localhost:3000
